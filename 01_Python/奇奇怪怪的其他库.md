# 奇奇怪怪的其他库

## 1 办公自动化

### 1.1 pyautogui键鼠操作

- 鼠标操作函数

> 操作鼠标点击的函数。

| 函数                                | 简单说明                                       |
| :---------------------------------- | :--------------------------------------------- |
| move(x,y)、 moveTo(x,y)             | 移动鼠标，前者移动相对位置，后者移动到指定位置 |
| click(x,y)、doubleClick、rightClick | 单击/双击/右击，无参版本在当前位置点击鼠标     |
| drag(x,y)、dragTo(x,y)              | 拖动鼠标                                       |
| mouseDown、mouseUp                  | 按下按键，松开按键                             |
| scroll                              | 向下滚动鼠标滚轮的函数                         |

- 键盘操作函数

> 操作键盘按键的函数。

| 函数                  | 简介               |
| :-------------------- | :----------------- |
| press(‘left’,press=3) |                    |
| hotkey(‘ctrl’,‘s’)    | 按下Ctrl+S组合键   |
| keyDown、keyUp        | 按下和松开键盘按键 |

- 提示框函数

> PyAutoGUI可以显示提示框，这时候程序会暂停运行，直到用户点击提示框。

| 函数                                           | 简介               |
| :--------------------------------------------- | :----------------- |
| alert(text=’’,title=’’,button=[‘OK’,‘Cancle’]) | 显示警告对话框     |
| confirm()                                      | 显示确认对话框     |
| prompt()                                       | 显示提示对话框     |
| password()                                     | 显示密码输入对话框 |

- 屏幕截图和定位函数

> 截取屏幕的函数，也可以从屏幕中寻找匹配的图片，并返回其坐标。你可以事先保存一些按钮的截图，然后通过这种方式定位按钮的位置，然后点击。

| 函数                    | 简介                                                         |
| :---------------------- | :----------------------------------------------------------- |
| screenshot(‘image.png’) | 保存截图并返回截图，无参版本直接返回截图不保存               |
| center(coords)          | The `coords` argument is a 4-integer tuple of (left, top, width, height)。返回中心点的坐标（x, y） |
| locateOnScreen(‘img’)   | 从屏幕寻找图片位置，直接返回坐标。可使用center得到中心点     |

- locateOnScreen在安装OpenCV后，可添加```confidence```参数

  ```python
  import pyautogui
  from PIL import Image
  
  img = Image.open('./main/00_缓存文件/Continue.jpg')
  res = pyautogui.locateOnScreen(img, confidence=0.5)
  print(res)  # Box(left=679, top=507, width=578, height=119)
  ```

  

### 1.2 pyperclip剪贴板

```python
import pyperclip

pyperclip.copy('1203')
print(pyperclip.paste())
```



## word

docxtql

```python
from docxtpl import DocxTemplate, InlineImage
from docx.shared import Mm

doc = DocxTemplate(r'./template/template1.docx')
context = {
    'now1_pic': InlineImage(doc, r'./cache/now_speed.jpg', [width=Mm(75), height=Mm(75)]),
    'name': 'fafa'
}
doc.render(context=context)
doc.save('test.docx')
```

插入图片报错

```
import requests
from io import BytesIO
from PIL import Image
response = requests.get(url)
image = Image.open(BytesIO(response.content))
image.save('./temp/temp.jpg')
```

## 图像识别之OpenCV

### 1.1 新建画布

```python
img = np.zeros((pic_height, pic_width, 3), np.uint8)
```

### 1.2 读取图片

```python
cv2.imread(path, flags)
```

- 参数意义
  - ```path```：该参数制定图片的路径，可以使用相对路径，也可以使用绝对路径；
  - ```flags```：指定以何种方式加载图片，有三个取值：
    - ```cv2.IMREAD_COLOR```：读取一副彩色图片，图片的透明度会被忽略，默认为该值，实际取值为```1```
    - ```cv2.IMREAD_GRAYSCALE```：以灰度模式读取一张图片，实际取值为```0```
    - ```cv2.IMREAD_UNCHANGED```：加载一副彩色图像，透明度不会被忽略

### 1.3 显示图片

```python
picName = 'example'
cv2.namedWindow(picName)
cv2.imshow(picName, img)
cv2.waitKey(0)
cv2.destroyAllWindows()
```

### 1.4 保存图片

```python
cv2.imwrite(filename, img)
```

### 2.1 画图形

```python
pos_right_1 = [v / 100 * pic_width, 0]
pos_right_2 = [pic_width, 0]
pos_right_3 = [pic_width, pic_height]
pos_right_4 = [v / 100 * pic_width, pic_height]
position_right = [np.array([pos_right_1, pos_right_2, pos_right_3, pos_right_4]).astype(np.int32)]

img = np.zeros((pic_height, pic_width, 3), np.uint8)
cv2.fillPoly(img, position_left, (3, 192, 255))
```

### 3.1 翻转

```python
res_img = cv2.flip(img, flipCode)
```

| 参数值  |                  说明                  |               意义               |
| :-----: | :------------------------------------: | :------------------------------: |
| ```0``` |             只能是```0```              |        绕着```x```轴翻转         |
|  正数   |  ```1```、```2```、```3```等任意正数   |        绕着```y```轴翻转         |
|  负数   | ```-1```、```-2```、```-3```等任意负数 | 围绕```x```轴、```y```轴同时翻转 |

### 3.2 裁切

```python
img[200:600, 0:300]   # 裁剪坐标为[y0:y1, x0:x1]
```



### 注意事项

- 每个像素为[B,G,R]的形式



## 图像识别之PIL





### 互转

```python
import cv2
from PIL import Image
import numpy
 
# cv2 转 PIL
img = cv2.imread("car.jpg")
cv2.imshow("OpenCV",img)
image = Image.fromarray(cv2.cvtColor(img,cv2.COLOR_BGR2RGB))
image.show()
cv2.waitKey()

 # PIL 转 cv2
image = Image.open("car.jpg")
image.show()
img = cv2.cvtColor(numpy.asarray(image),cv2.COLOR_RGB2BGR)
cv2.imshow("OpenCV",img)
cv2.waitKey()
```



### SVG

```cmd
cairosvg img.svg -o img.png
```

```python
import cairosvg

svg_path = 'img.svg'
png_path = 'img.png'
cairosvg.svg2png(url=svg_path, write_to=png_path)
```



